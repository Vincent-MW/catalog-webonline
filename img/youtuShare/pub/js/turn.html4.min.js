(function(R){function E(T,A,S){if(!S[0]||"object"==typeof S[0]){return A.init.apply(T,S)}if(A[S[0]]){return A[S[0]].apply(T,Array.prototype.slice.call(S,1))}throw D(S[0]+" is an invalid value")}function K(U,A,S,T){return{css:{position:"absolute",top:U,left:A,overflow:T||"hidden","z-index":S||"auto"}}}function M(A,S,T,U,V){var X=1-V,W=X*X*X,Y=V*V*V;return F(Math.round(W*A.x+3*V*X*X*S.x+3*V*V*X*T.x+Y*U.x),Math.round(W*A.y+3*V*X*X*S.y+3*V*V*X*T.y+Y*U.y))}function F(S,A){return{x:S,y:A}}function C(S,A){return Object.prototype.hasOwnProperty.call(A,S)}function D(S){function A(T){this.name="TurnJsError";this.message=T}A.prototype=Error();A.prototype.constructor=A;return new A(S)}function N(){return""}var L="",G={down:"mousedown",move:"mousemove",up:"mouseup",over:"mouseover",out:"mouseout"},J={backward:["l"],forward:["r"],all:["l","r"]},P=["single","double"],H=["ltr","rtl"],I={acceleration:!0,display:"double",duration:600,page:1,gradients:!0,when:null},O={acceleration:!0,corners:"forward",cornerSize:100,duration:600,gradients:!0},B={init:function(W){if(1<this.length){throw D("This selector has more than 1 element")}for(var T=["Moz","Webkit","Khtml","O","ms"],U=T.length,V="";U--;){T[U]+"Transform" in document.body.style&&(V="-"+T[U].toLowerCase()+"-")}L=V;var S,T=0,A=this.data(),U=this.children(),W=R.extend({width:this.width(),height:this.height(),direction:this.attr("dir")||this.css("direction")||"ltr"},I,W);A.opts=W;A.pageObjs={};A.pages={};A.pageWrap={};A.pagePlace={};A.pageMv=[];A.zoom=1;A.totalPages=W.pages||0;A.docEvents={mouseStart:function(X){for(var Y in A.pages){if(C(Y,A.pages)&&!1===Q._eventStart.call(A.pages[Y],X)){return !1}}},mouseMove:function(X){for(var Y in A.pages){C(Y,A.pages)&&Q._eventMove.call(A.pages[Y],X)}},mouseEnd:function(X){for(var Y in A.pages){C(Y,A.pages)&&Q._eventEnd.call(A.pages[Y],X)}}};if(W.when){for(S in W.when){C(S,W.when)&&this.bind(S,W.when[S])}}this.css({position:"relative",width:W.width,height:W.height});this.turn("display",W.display);""!==W.direction&&this.turn("direction",W.direction);for(S=0;S<U.length;S++){"1"!=R(U[S]).attr("ignore")&&this.turn("addPage",U[S],++T)}R(this).bind(G.down,A.docEvents.mouseStart).bind("start",B._start).bind("end",B._end).bind("pressed",B._pressed).bind("released",B._released).bind("flip",B._flip);R(document).bind(G.move,A.docEvents.mouseMove).bind(G.up,A.docEvents.mouseEnd);this.turn("page",W.page);A.done=!0;return this},addPage:function(W,T){var U,V=!1,S=this.data(),A=S.totalPages+1;if(S.destroying){return !1}if(U=/\bp([0-9]+)\b/.exec(R(W).attr("class"))){T=parseInt(U[1],10)}if(T){if(T==A){V=!0}else{if(T>A){throw D('Page "'+T+'" cannot be inserted')}}}else{T=A,V=!0}1<=T&&T<=A&&(U="double"==S.display?T%2?" odd":" even":"",S.done&&this.turn("stop"),T in S.pageObjs&&B._movePages.call(this,T,1),V&&(S.totalPages=A),S.pageObjs[T]=R(W).css({"float":"left"}).addClass("page p"+T+U),B._addPage.call(this,T),S.done&&this.turn("update"),B._removeFromDOM.call(this));return this},_addPage:function(U){var A=this.data(),S=A.pageObjs[U];if(S){if(B._necessPage.call(this,U)){if(!A.pageWrap[U]){var T=B._pageSize.call(this,U,!0);S.css({width:T.width,height:T.height});A.pagePlace[U]=U;A.pageWrap[U]=R("<div/>",{"class":"turn-page-wrapper",page:U,css:{position:"absolute",overflow:"hidden"}}).css(T);this.append(A.pageWrap[U]);A.pageWrap[U].prepend(A.pageObjs[U])}(!U||1==B._setPageLoc.call(this,U))&&B._makeFlip.call(this,U)}else{A.pagePlace[U]=0,A.pageObjs[U]&&A.pageObjs[U].remove()}}},hasPage:function(A){return C(A,this.data().pageObjs)},center:function(U){var A=this.data(),S=R(this).turn("size"),T=S.width/(2*A.zoom)-S.width/2;"double"==A.display&&(U=this.turn("view",U||A.tpage||A.page),"ltr"==A.direction?U[0]?U[1]||(T+=S.width/4):T-=S.width/4:U[0]?U[1]||(T-=S.width/4):T+=S.width/4);R(this).css({marginLeft:T});return this},destroy:function(){var A=this.data();A.destroying=!0;R(this).unbind(G.down).unbind("end").unbind("first").unbind("flip").unbind("last").unbind("pressed").unbind("released").unbind("start").unbind("turning").unbind("turned").unbind("zooming");for(R(document).unbind(G.move,A.docEvents.mouseMove).unbind(G.up,A.docEvents.mouseEnd);0!==A.totalPages;){this.turn("removePage",A.totalPages)}A.fparent&&A.fparent.remove();A.shadow&&A.shadow.remove();this.removeData();return this},is:function(){return"object"==typeof this.data().pages},zoom:function(W){var T=this.data();if("number"==typeof W){if(0.001>W||100<W){throw D(W+" is not a value for zoom")}var U=R.Event("zooming");this.trigger(U,[W,T.zoom]);if(U.isDefaultPrevented()){return this}var U=R(this).turn("size"),V=1/T.zoom,S=Math.round(U.width*V*W),A=Math.round(U.height*V*W);T.zoom=W;R(this).turn("stop").turn("size",S,A).css({marginTop:U.height*V/2-A/2});T.opts.autoCenter?this.turn("center"):R(this).css({marginLeft:U.width*V/2-S/2});B._updateShadow.call(this);return this}return T.zoom},_pageSize:function(X,U){var V=this.data(),W={};if("single"==V.display){W.width=this.width(),W.height=this.height(),U&&(W.top=0,W.left=0,W.right="auto")}else{var T=this.width()/2,S=this.height();V.pageObjs[X].hasClass("own-size")?(W.width=V.pageObjs[X].width(),W.height=V.pageObjs[X].height()):(W.width=T,W.height=S);if(U){var A=X%2;W.top=(S-W.height)/2;"ltr"==V.direction?(W[A?"right":"left"]=T-W.width,W[A?"left":"right"]="auto"):(W[A?"left":"right"]=T-W.width,W[A?"right":"left"]="auto")}}return W},_makeFlip:function(U){var A=this.data();if(!A.pages[U]&&A.pagePlace[U]==U){var S="single"==A.display,T=U%2;A.pages[U]=A.pageObjs[U].css(B._pageSize.call(this,U)).flip({page:U,next:T||S?U+1:U-1,turn:this,duration:A.opts.duration,acceleration:A.opts.acceleration,gradients:A.opts.gradients}).flip("disable",A.disabled)}return A.pages[U]},_makeRange:function(){var S,A;if(!(1>this.data().totalPages)){A=this.turn("range");for(S=A[0];S<=A[1];S++){B._addPage.call(this,S)}}},range:function(V){var S,T,U,A=this.data(),V=V||A.tpage||A.page||1;U=B._view.call(this,V);if(1>V||V>A.totalPages){throw D('"'+V+'" is not a page for range')}U[1]=U[1]||U[0];1<=U[0]&&U[1]<=A.totalPages?(V=Math.floor(2),A.totalPages-U[1]>U[0]?(S=Math.min(U[0]-1,V),T=2*V-S):(T=Math.min(A.totalPages-U[1],V),S=2*V-T)):T=S=5;return[Math.max(1,U[0]-S),Math.min(A.totalPages,U[1]+T)]},_necessPage:function(T){if(0===T){return !0}var A=this.data(),S=this.turn("range");return A.pageObjs[T].hasClass("fixed")||T>=S[0]&&T<=S[1]},_removeFromDOM:function(){var S,A=this.data();for(S in A.pageWrap){C(S,A.pageWrap)&&!B._necessPage.call(this,S)&&B._removePageFromDOM.call(this,S)}},_removePageFromDOM:function(T){var A=this.data();if(A.pages[T]){var S=A.pages[T].data();Q._moveFoldingPage.call(A.pages[T],!1);S.f&&S.f.fwrapper&&S.f.fwrapper.remove();A.pages[T].removeData();A.pages[T].remove();delete A.pages[T]}A.pageObjs[T]&&A.pageObjs[T].remove();A.pageWrap[T]&&(A.pageWrap[T].remove(),delete A.pageWrap[T]);delete A.pagePlace[T]},removePage:function(S){var A=this.data();if(1>S||S>A.totalPages){throw D("The page "+S+" doesn't exist")}A.pageObjs[S]&&(this.turn("stop"),B._removePageFromDOM.call(this,S),delete A.pageObjs[S]);B._movePages.call(this,S,-1);A.totalPages-=1;A.page>A.totalPages?this.turn("page",A.totalPages):B._makeRange.call(this);return this},_movePages:function(X,U){var V,W=this,T=this.data(),S="single"==T.display,A=function(a){var b=a+U,Y=b%2,Z=Y?" odd ":" even ";T.pageObjs[a]&&(T.pageObjs[b]=T.pageObjs[a].removeClass("p"+a+" odd even").addClass("p"+b+Z));T.pagePlace[a]&&T.pageWrap[a]&&(T.pagePlace[b]=b,T.pageWrap[b]=T.pageObjs[b].hasClass("fixed")?T.pageWrap[a].attr("page",b):T.pageWrap[a].css(B._pageSize.call(W,b,!0)).attr("page",b),T.pages[a]&&(T.pages[b]=T.pages[a].flip("options",{page:b,next:S||Y?b+1:b-1,corners:S?"all":Y?"forward":"backward"})),U&&(delete T.pages[a],delete T.pagePlace[a],delete T.pageObjs[a],delete T.pageWrap[a],delete T.pageObjs[a]))};if(0<U){for(V=T.totalPages;V>=X;V--){A(V)}}else{for(V=X;V<=T.totalPages;V++){A(V)}}},display:function(T){var A=this.data(),S=A.display;if(T){if(-1==R.inArray(T,P)){throw D('"'+T+'" is not a value for display')}"single"==T?A.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),A.pageObjs[0]=R("<div />",{"class":"page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)):A.pageObjs[0]&&(this.turn("stop").css({overflow:""}),A.pageObjs[0].remove(),delete A.pageObjs[0]);A.display=T;S&&(T=this.turn("size"),B._movePages.call(this,1,0),this.turn("size",T.width,T.height).turn("update"));return this}return S},direction:function(S){var A=this.data();if("undefined"==typeof S){return A.direction}S=S.toLowerCase();if(-1==R.inArray(S,H)){throw D('"'+S+'" is not a value for direction')}"rtl"==S&&R(this).attr("dir","ltr").css({direction:"ltr"});A.direction=S;A.done&&this.turn("size",R(this).width(),R(this).height());return this},animating:function(){return 0<this.data().pageMv.length},disable:function(U){var A,S=this.data(),T=this.turn("view");S.disabled=void 0===U||!0===U;for(A in S.pages){C(A,S.pages)&&S.pages[A].flip("disable",U?R.inArray(A,T):!1)}return this},disabled:function(A){return void 0===A?!0===this.data().disabled:this.turn("disable",A)},size:function(V,S){if(V&&S){var T,U,A=this.data();U="double"==A.display?V/2:V;this.css({width:V,height:S});A.pageObjs[0]&&A.pageObjs[0].css({width:U,height:S});for(T in A.pageWrap){C(T,A.pageWrap)&&(U=B._pageSize.call(this,T,!0),A.pageObjs[T].css({width:U.width,height:U.height}),A.pageWrap[T].css(U),A.pages[T]&&A.pages[T].css({width:U.width,height:U.height}))}this.turn("resize");return this}return{width:this.width(),height:this.height()}},resize:function(){var S,A=this.data();A.pages[0]&&(A.pageWrap[0].css({left:-this.width()}),A.pages[0].flip("resize",!0));for(S=1;S<=A.totalPages;S++){A.pages[S]&&A.pages[S].flip("resize",!0)}},_removeMv:function(T){var A,S=this.data();for(A=0;A<S.pageMv.length;A++){if(S.pageMv[A]==T){return S.pageMv.splice(A,1),!0}}return !1},_addMv:function(S){var A=this.data();B._removeMv.call(this,S);A.pageMv.push(S)},_view:function(S){var A=this.data(),S=S||A.page;return"double"==A.display?S%2?[S-1,S]:[S,S+1]:[S]},view:function(S){var A=this.data(),S=B._view.call(this,S);return"double"==A.display?[0<S[0]?S[0]:0,S[1]<=A.totalPages?S[1]:0]:[0<S[0]&&S[0]<=A.totalPages?S[0]:0]},stop:function(){if(this.turn("animating")){var V,S,T,U=this.data(),A=U.pageMv;U.pageMv=[];U.tpage&&(U.page=U.tpage,delete U.tpage);for(V=0;V<A.length;V++){T=U.pages[A[V]],S=T.data().f.opts,T.flip("hideFoldedPage",!1),Q._moveFoldingPage.call(T,!1),U.pagePlace[S.next]=S.next,S.force&&(S.next=0===S.page%2?S.page-1:S.page+1,delete S.force)}}this.turn("update");return this},pages:function(T){var A=this.data();if(T){if(T<A.totalPages){for(var S=T+1;S<=A.totalPages;S++){this.turn("removePage",S)}this.turn("page")>T&&this.turn("page",T)}A.totalPages=T;return this}return A.totalPages},_missing:function(U){for(var A=this.data(),S=this.turn("range",U),T=[],U=S[0];U<=S[1];U++){A.pageObjs[U]||T.push(U)}0<T.length&&this.trigger("missing",[T])},_fitPage:function(T){var A=this.data(),S=this.turn("view",T);B._missing.call(this,T);A.pageObjs[T]&&(A.page=T,this.turn("stop"),B._removeFromDOM.call(this),B._makeRange.call(this),B._updateShadow.call(this),this.trigger("turned",[T,S]),A.opts.autoCenter&&this.turn("center"))},_turnPage:function(A,S){var T,U,V=this.data(),X=V.pagePlace[A],Z=this.turn("view"),W=this.turn("view",A);if(V.page!=A){var Y=R.Event("turning");this.trigger(Y,[A,W]);if(Y.isDefaultPrevented()){return}-1!=R.inArray(1,W)&&this.trigger("first");-1!=R.inArray(V.totalPages,W)&&this.trigger("last")}if(S){this.turn("stop",X)}else{B._missing.call(this,A);if(!V.pageObjs[A]){return}this.turn("stop");V.page=A}B._makeRange.call(this);"single"==V.display?(T=Z[0],U=W[0]):Z[1]&&A>Z[1]?(T=Z[1],U=W[0]):Z[0]&&A<Z[0]&&(T=Z[0],U=W[1]);V.pages[T]&&(X=V.pages[T].data().f.opts,V.tpage=U,X.next!=U&&(X.next=U,V.pagePlace[U]=X.page,X.force=!0),"single"==V.display?"ltr"==V.direction?V.pages[T].flip("turnPage",W[0]>Z[0]?"r":"l"):V.pages[T].flip("turnPage",W[0]>Z[0]?"l":"r"):V.pages[T].flip("turnPage"))},page:function(S){var S=parseInt(S,10),A=this.data();return 0<S&&S<=A.totalPages?(!A.done||-1!=R.inArray(S,this.turn("view"))?B._fitPage.call(this,S):B._turnPage.call(this,S),this):A.page},next:function(){return this.turn("page",B._view.call(this,this.data().page).pop()+1)},previous:function(){return this.turn("page",B._view.call(this,this.data().page).shift()-1)},peel:function(){return this},_addMotionPage:function(){var T=R(this).data().f.opts,A=T.turn,S=A.data();B._addMv.call(A,T.page);S.pagePlace[T.next]=T.page;A.turn("update")},_start:function(U,A,S){var T=A.turn.data();U.isDefaultPrevented()||("single"==T.display&&S&&("l"==S&&"ltr"==T.direction||"r"==S&&"rtl"==T.direction?(A.next=A.next<A.page?A.next:A.page-1,A.force=!0):A.next=A.next>A.page?A.next:A.page+1),B._addMotionPage.call(U.target));B._updateShadow.call(A.turn)},_end:function(U,A,S){R(U.target).data();var U=A.turn,T=U.data();if(S||T.tpage){if(T.tpage==A.next||T.tpage==A.page){delete T.tpage,B._fitPage.call(U,T.tpage||A.next,!0)}}else{B._removeMv.call(U,A.page),B._updateShadow.call(U),U.turn("update")}},_pressed:function(T){T.stopPropagation();var A,T=R(T.target).data().f,S=T.opts.turn.data().pages;for(A in S){A!=T.opts.page&&S[A].flip("disable",!0)}return T.time=(new Date).getTime()},_released:function(U,V){U.stopPropagation();var W,X=R(U.target),A=X.data().f,S=A.opts.turn,T=S.data();W="single"==T.display?"r"==V.corner?V.x<X.width()/2:V.x>X.width()/2:0>V.x||V.x>X.width();if(200>(new Date).getTime()-A.time||W){U.preventDefault(),B._turnPage.call(S,A.opts.next,!1===Q._cornerActivated.call(X,V,1))}T.mouseAction=!1},_flip:function(A){A.stopPropagation();A=R(A.target).data().f.opts;A.turn.trigger("turn",[A.next]);A.turn.data().opts.autoCenter&&A.turn.turn("center",A.next)},calculateZ:function(T){var U,V,W,Y,a=this,Z=this.data();U=this.turn("view");var A=U[0]||U[1],X={pageZ:{},partZ:{},pageV:{}},S=function(b){b=a.turn("view",b);b[0]&&(X.pageV[b[0]]=!0);b[1]&&(X.pageV[b[1]]=!0)};for(U=0;U<T.length;U++){V=T[U],W=Z.pages[V].data().f.opts.next,Y=Z.pagePlace[V],S(V),S(W),V=Z.pagePlace[W]==W?W:V,X.pageZ[V]=Z.totalPages-Math.abs(A-V),X.partZ[Y]=2*Z.totalPages+Math.abs(A-V)}return X},update:function(){var U,A=this.data();if(A.pageMv.length&&0!==A.pageMv[0]){var S,T=this.turn("calculateZ",A.pageMv);this.turn("view",A.tpage);for(U in A.pageWrap){if(C(U,A.pageWrap)&&(S=A.pageObjs[U].hasClass("fixed"),A.pageWrap[U].css({display:T.pageV[U]||S?"":"none","z-index":T.pageZ[U]||(S?-1:0)}),S=A.pages[U])){S.flip("z",T.partZ[U]||null),T.pageV[U]&&S.flip("resize"),A.tpage&&S.flip("disable",!0)}}}else{for(U in A.pageWrap){C(U,A.pageWrap)&&(T=B._setPageLoc.call(this,U),A.pages[U]&&A.pages[U].flip("disable",A.disabled||1!=T).flip("z",null))}}},_updateShadow:function(){var U,V,W=this.data(),X=this.width(),A=this.height(),S="single"==W.display?X:X/2;U=this.turn("view");W.shadow||(W.shadow=R("<div />",{"class":"shadow",css:K(0,0,0).css}).appendTo(this));for(var T=0;T<W.pageMv.length&&U[0]&&U[1];T++){U=this.turn("view",W.pages[W.pageMv[T]].data().f.opts.next),V=this.turn("view",W.pageMv[T]),U[0]=U[0]&&V[0],U[1]=U[1]&&V[1]}switch(U[0]?U[1]?3:"ltr"==W.direction?2:1:"ltr"==W.direction?1:2){case 1:W.shadow.css({width:S,height:A,top:0,left:S});break;case 2:W.shadow.css({width:S,height:A,top:0,left:0});break;case 3:W.shadow.css({width:X,height:A,top:0,left:0})}},_setPageLoc:function(T){var A=this.data(),S=this.turn("view");if(T==S[0]||T==S[1]){return A.pageWrap[T].css({zIndex:A.totalPages,display:""}),1}if("single"==A.display&&T==S[0]+1||"double"==A.display&&T==S[0]-2||T==S[1]+2){return A.pageWrap[T].css({zIndex:A.totalPages-1,display:""}),2}A.pageWrap[T].css({zIndex:0,display:A.pageObjs[T].hasClass("fixed")?"":"none"});return 0},options:function(T){if(void 0===T){return this.data().opts}var A=this.data();R.extend(A.opts,T);T.pages&&this.turn("pages",T.pages);T.page&&this.turn("page",T.page);T.display&&this.turn("display",T.display);T.direction&&this.turn("direction",T.direction);T.width&&T.height&&this.turn("size",T.width,T.height);if(T.when){for(var S in T.when){C(S,T.when)&&this.unbind(S).bind(S,T.when[S])}}return this},version:function(){return"4.1.0"}},Q={init:function(A){this.data({f:{effect:"r"==A.corners||"l"==A.corners?"hard":"sheet"}});this.flip("options",A);Q._addPageWrapper.call(this);return this},setData:function(S){var A=this.data();A.f=R.extend(A.f,S);return this},options:function(S){var A=this.data().f;return S?(Q.setData.call(this,{opts:R.extend({},A.opts||O,S)}),this):A.opts},z:function(S){var A=this.data().f;A.fwrapper&&(A.opts["z-index"]=S,A.fwrapper.css({"z-index":S||parseInt(A.parent.css("z-index"),10)||0}));return this},_cAllowed:function(){var T=this.data().f,A=T.opts.turn.data(),T=T.opts.page,S=T%2;return"single"==A.display?1==T?"ltr"==A.direction?J.forward:J.backward:T==A.totalPages?"ltr"==A.direction?J.backward:J.forward:J.all:"ltr"==A.direction?J[S?"forward":"backward"]:J[S?"backward":"forward"]},_cornerActivated:function(V){var S=this.data().f,T=S.parent.offset(),U=this.width(),A=this.height(),V={x:Math.max(0,V.pageX-T.left),y:Math.max(0,V.pageY-T.top)},S=S.opts.cornerSize;if(0>=V.x||0>=V.y||V.x>=U||V.y>=A){return !1}A=Q._cAllowed.call(this);if(V.x>U-S){V.corner="r"}else{if(V.x<S){V.corner="l"}else{return !1}}return -1==R.inArray(V.corner,A)?!1:V},_c:function(S,A){A=A||0;switch(S){case"l":return F(A,0);case"r":return F(this.width()-A,0)}},_c2:function(A){switch(A){case"l":return F(2*this.width(),0);case"r":return F(-this.width(),0)}},_foldingPage:function(){var S=this.data().f,A=S.opts;if(S.folding){return S.folding}if(A.turn){return S=A.turn.data(),"single"==S.display?S.pageObjs[A.next]?S.pageObjs[0]:null:S.pageObjs[A.next]}},_backGradient:function(){var S=this.data().f,A=S.opts.turn;return S.opts.gradients&&(!A||"single"==A.data().display||2!=S.opts.page&&S.opts.page!=A.data().totalPages-1)},resize:function(U){var A=this.data().f,S=this.width(),T=this.height();U&&(A.wrapper.css({width:S,height:T}),A.fpage.css({width:S,height:T}))},_addPageWrapper:function(){var T=this.data().f,A=this.parent();T.parent=A;if(!T.wrapper){var S={};T.wrapper=R("<div/>",K(0,0,2)).css(S).appendTo(A).prepend(this);T.fpage=R("<div/>",K(0,0,1)).css(S).appendTo(A)}Q.resize.call(this,!0)},_fold:function(U){var A=this.data().f,S=Q._c.call(this,U.corner),S=S.x?S.x-U.x:U.x,T=this.width();this.height();S=Math.min(2*T,Math.max(0,S));switch(U.corner){case"r":A.wrapper.css({width:Math.max(0,T-S)});this.css({position:"relative",left:-S});A.fpage.css({left:-S+T,width:Math.max(0,S-T)});break;case"l":A.wrapper.css({width:T}),this.css({position:"relative",left:S}),A.fpage.css({left:T,width:Math.max(0,S-T)}),A.folding&&A.folding.css({position:"relative",left:2*-T+S})}A.parent.css({overflow:"visible"});A.point=U},_moveFoldingPage:function(T){var A=this.data().f;if(T){var T=Q._foldingPage.call(this),S=A.opts.turn;if(T){if(A.folding){if(A.folding===T){return}Q._moveFoldingPage.call(this,!1)}Q.setData.call(this,{backParent:T.parent(),folding:T});A.fpage.prepend(T)}S.turn("update")}else{A.backParent&&(A.backParent.prepend(A.folding),delete A.backParent,delete A.folding)}},_showFoldedPage:function(S,T){var U=Q._foldingPage.call(this),V=this.data(),W=V.f,X=W.visible;if(!X||!W.point||W.point.corner!=S.corner){W.opts.turn.data();var Y=R.Event("start");this.trigger(Y,[W.opts,S.corner]);X=!1;if(Y.isDefaultPrevented()){return !1}}if(U){if(T){var A=this,U=W.point&&W.point.corner==S.corner?W.point:Q._c.call(this,S.corner,1);this.animatef({from:[U.x,U.y],to:[S.x,S.y],duration:500,frame:function(Z){S.x=Math.round(Z[0]);S.y=Math.round(Z[1]);Q._fold.call(A,S)}})}else{Q._fold.call(this,S),V.effect&&!V.effect.turning&&this.animatef(!1)}X||(W.visible=!0,Q._moveFoldingPage.call(this,!0),W.fpage.show());return !0}return !1},hide:function(){var A=this.data().f;Q._foldingPage.call(this);this.css({position:"",left:"auto"});A.wrapper.css({width:this.width()});A.fpage.css({width:this.width()});A.folding&&A.folding.css({position:"",left:"auto"});A.fpage.hide();A.visible=!1;return this},hideFoldedPage:function(A){var S=this.data().f;if(S.point){var T=this,U=S.point,V=function(){S.point=null;T.flip("hide");T.trigger("end",[S.opts,!1])};if(A){var X=Q._c.call(this,U.corner),A="t"==U.corner.substr(0,1)?Math.min(0,U.y-X.y)/2:Math.max(0,U.y-X.y)/2,W=F(U.x,U.y+A),Y=F(X.x,X.y-A);this.animatef({from:0,to:1,frame:function(Z){Z=M(U,W,Y,X,Z);U.x=Z.x;U.y=Z.y;Q._fold.call(T,U)},complete:V,duration:800,hiding:!0})}else{this.animatef(!1),V()}}},turnPage:function(V){var S=this,T=this.data().f,V={corner:T.corner?T.corner.corner:V||Q._cAllowed.call(this)[0]},U=T.point||Q._c.call(this,V.corner,T.opts.turn?T.opts.turn.data().opts.elevation:0),A=Q._c2.call(this,V.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(W){W=M(U,U,A,A,W);V.x=W.x;V.y=W.y;Q._showFoldedPage.call(S,V)},complete:function(){S.trigger("end",[T.opts,!0])},duration:T.opts.duration,turning:!0});T.corner=null},moving:function(){return"effect" in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(S){var A=this.data().f;if(!A.disabled&&!this.flip("isTurning")){A.corner=Q._cornerActivated.call(this,S);if(A.corner&&Q._foldingPage.call(this,A.corner)){return Q._showFoldedPage.call(this,A.corner)&&this.trigger("pressed",[A.point]),!1}A.corner=null}},_eventMove:function(T){var A=this.data().f;if(!A.disabled){if(T=[T],A.corner){var S=A.parent.offset();A.corner.x=T[0].pageX-S.left;A.corner.y=T[0].pageY-S.top;Q._showFoldedPage.call(this,A.corner)}else{!this.data().effect&&this.is(":visible")&&((T=Q._cornerActivated.call(this,T[0]))?(A=Q._c.call(this,T.corner,A.opts.cornerSize/2),T.x=A.x,T.y=A.y,Q._showFoldedPage.call(this,T,!0)):Q.hideFoldedPage.call(this,!0))}}},_eventEnd:function(){var S=this.data().f;if(!S.disabled&&S.point){var A=R.Event("released");this.trigger(A,[S.point]);A.isDefaultPrevented()||Q.hideFoldedPage.call(this,!0)}S.corner=null},disable:function(A){Q.setData.call(this,{disabled:A});return this}};window.requestAnim=function(A){window.setTimeout(A,1000/60)};R.extend(R.fn,{flip:function(S,A){return E(this,Q,arguments)},turn:function(A){return E(this,B,arguments)},transform:function(T,A){var S={};A&&(S[L+"transform-origin"]=A);S[L+"transform"]=T;return this.css(S)},animatef:function(S){var T=this.data();T.effect&&T.effect.stop();if(S){S.to.length||(S.to=[S.to]);S.from.length||(S.from=[S.from]);for(var U=[],V=S.to.length,X=!0,Y=this,Z=(new Date).getTime(),W=function(){if(T.effect&&X){for(var b=[],a=Math.min(S.duration,(new Date).getTime()-Z),c=0;c<V;c++){b.push(T.effect.easing(1,a,S.from[c],U[c],S.duration))}S.frame(1==V?b[0]:b);a==S.duration?(delete T.effect,Y.data(T),S.complete&&S.complete()):window.requestAnim(W)}},A=0;A<V;A++){U.push(S.to[A]-S.from[A])}T.effect=R.extend({stop:function(){X=!1},easing:function(c,d,e,a,b){return a*Math.sqrt(1-(d=d/b-1)*d)+e}},S);this.data(T);W()}else{delete T.effect}}});R.isTouch=!1;R.mouseEvents=G;R.cssPrefix=N;R.cssTransitionEnd=N;R.findPos=function(S){var A={top:0,left:0};do{A.left+=S.offsetLeft,A.top+=S.offsetTop}while(S=S.offsetParent);return A}})(jQuery);